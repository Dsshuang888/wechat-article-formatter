# 公众号文章排版工具部署指南

## 问题修复说明

已彻底修复下载功能保护机制：
- ✅ 完全重写了保护逻辑，只允许工具生成的内容下载
- ✅ 严格验证下载文件类型（只允许.html、.json、.zip、.txt、.md）
- ✅ 双重验证：类标记 + 文件名模式匹配
- ✅ 阻止所有未授权的下载尝试
- ✅ 修复了下载文件中代码高亮缺失的问题，现在下载的HTML文件包含完整的代码高亮支持
- ✅ 增强的源码保护：
  - 禁用右键菜单
  - 阻止 Ctrl+S、Ctrl+U、F12 等快捷键
  - 监控开发者工具使用
  - 拦截非授权的 Blob URL 创建
  - 保护关键函数不被重写

现在用户可以正常下载排版文件，但无法获取页面源码。

## 部署方式

### 1. GitHub Pages 部署（推荐）

1. **创建 GitHub 仓库**
   ```bash
   # 在 GitHub 上创建新仓库，然后上传文件
   git init
   git add .
   git commit -m "初始化公众号排版工具"
   git branch -M main
   git remote add origin https://github.com/你的用户名/你的仓库名.git
   git push -u origin main
   ```

2. **启用 GitHub Pages**
   - 进入仓库设置 → Pages
   - Source 选择 "Deploy from a branch"
   - Branch 选择 "main" / "root"
   - 点击 Save

3. **访问地址**
   - 工具地址：`https://你的用户名.github.io/你的仓库名/公众号文章排版工具.html`

### 2. Vercel 部署

1. **安装 Vercel CLI**
   ```bash
   npm i -g vercel
   ```

2. **部署项目**
   ```bash
   vercel --prod
   ```

3. **访问地址**
   - Vercel 会提供一个自动生成的域名

### 3. Netlify 部署

1. **拖拽部署**
   - 访问 [Netlify](https://netlify.com)
   - 直接拖拽整个文件夹到部署区域

2. **访问地址**
   - Netlify 会提供一个自动生成的域名

### 4. 本地测试

使用 Python 简单服务器：
```bash
# Python 3
python -m http.server 8000

# Python 2
python -m SimpleHTTPServer 8000
```

然后访问：`http://localhost:8000/公众号文章排版工具.html`

## 文件说明

- `公众号文章排版工具.html` - 主工具文件（推荐使用）
- `index.html` - 首页文件（包含认证）
- `login.html` - 登录页面
- `预设排版.json` - 预设模板配置
- `公众号文章排版工具_files/` - 依赖资源文件夹

## 使用建议

1. **推荐直接访问**：`公众号文章排版工具.html`
2. **模板备份**：定期导出自定义模板进行备份
3. **浏览器兼容**：建议使用现代浏览器（Chrome、Firefox、Safari、Edge）

## 常见问题

### Q: 下载功能不工作？
A: 已修复过度保护问题，现在应该可以正常下载。如仍有问题，请尝试：
- 换用不同浏览器
- 检查浏览器下载设置
- 清除浏览器缓存

### Q: 如何自定义域名？
A: 
- GitHub Pages：可通过 CNAME 文件设置自定义域名
- Vercel/Netlify：在控制面板中设置自定义域名

### Q: 文件太大无法上传？
A: 可以删除 `公众号文章排版工具_files/` 中不必要的文件，或使用 Git LFS

## 技术支持

如遇到问题，请检查：
1. 浏览器控制台是否有错误信息
2. 网络连接是否正常
3. 文件路径是否正确

---

现在你的排版工具应该可以正常使用下载功能了！ 